<html>

<head>
<meta name=Generator content="Microsoft Office HTML Filter 2.0">
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<meta name=Originator content="Microsoft Word 9">
<title>//================================================================ </title>
<style>
<!--
 
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";
	color:blue;
	font-style:italic;}
-->
</style>
</head>

<body lang=DE>

<div class=Section1>

<p class=MsoNormal><i><span lang=EN-US style='color:blue;'>//================================================================</span></i></p>

<p class=MsoNormal><i><span lang=EN-US style='color:blue;'>// ===== COM Test Example for Dialing Lemmatizer (www.aot.ru) ==</span></i></p>

<p class=MsoNormal><i><span lang=EN-US style='color:blue;'>// ===== Author: Alexey Sokirko, sokirko@yandex.ru, 2004 =======</span></i></p>

<p class=MsoBodyText><span lang=EN-US>//================================================================</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US>program</span></b><span
lang=EN-US> MorphTest;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>{$APPTYPE
CONSOLE}</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US>uses</span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;
SysUtils,</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;
ActiveX,</span></p>

<p class=MsoNormal><i><span lang=EN-US style='color:blue;'>//Unit LEMMATIZERLib_TLB.pas is generated  by Lemmatizer.dll. In Delphi 6 one should use menu "Project/Import Type Library".</span></i></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;
LEMMATIZERLib_TLB in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
'..\..\..\..\Programme\Borland\Delphi6\Imports\LEMMATIZERLib_TLB.pas';</span></p>
<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US>procedure</span></b><span
lang=EN-US> TestRusLemmatizer(word : <b>string</b>);</span></p>

<p class=MsoNormal><b>var</b>&nbsp; RusLemmatizer : ILemmatizer;</p>

<p class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp; <span lang=EN-US>ParadigmCollection : IParadigmCollection;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;
Lemma: WideString;</span></p>

<p class=MsoNormal><b><span lang=EN-US>begin</span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
</span><span lang=IT>RusLemmatizer :=
CoLemmatizerRussian.Create;</span></p>

<p class=MsoNormal><span lang=IT>&nbsp;&nbsp;&nbsp;
</span><b><span lang=EN-US>if</span></b><span
lang=EN-US>&nbsp; (RusLemmatizer = nil) <b>then</b></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
<b>begin</b></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
writeln(<i><span style='color:blue'>'cannot load lemmatizer'</span></i>);</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
halt(1);</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
<b>end</b>;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
RusLemmatizer.LoadDictionariesRegistry();</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
ParadigmCollection := RusLemmatizer.CreateParadigmCollectionFromForm(word, 1, 1);</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
<b>if</b>&nbsp; (ParadigmCollection.Count &gt; 0) <b>then</b></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
<b>begin</b></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Lemma := ParadigmCollection.Item[0].Norm;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
writeln(<i><span style='color:blue'>'</span></i></span><i><span lang=RU
style='color:blue;'>лемма</span></i><i><span lang=EN-US
style='color:blue;'>('</span></i><span lang=EN-US>,word,<i><span style='color:blue'>') = '</span></i>,Lemma);</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
<b>end</b></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
<b>else</b></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
writeln(<i><span style='color:blue'>'not found'</span></i>);</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US>end</span></b><span
lang=EN-US>;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US>var</span></b><span
lang=EN-US>&nbsp;&nbsp; hr :&nbsp; HRESULT;</span></p>

<p class=MsoNormal><b><span lang=EN-US>begin</span></b></p>

<p class=MsoNormal><b><span lang=EN-US>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US>try</span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
hr := CoInitialize(<b>nil</b>);</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
<b>if</b> (hr &lt;&gt; S_OK) <b>then</b></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
<b>begin</b></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
writeln(<i><span style='color:blue'>'cannot load Component Object Model(COM)
library'</span></i>);</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
halt(1);</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
<b>end</b>;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
TestRusLemmatizer(<i><span style='color:blue'>'</span></i></span><i><span
lang=RU style='color:blue;'>маму</span></i><i><span
lang=EN-US style='color:blue;'>'</span></i><span
lang=EN-US>);</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
CoUninitialize();</span></p>

<p class=MsoNormal><b><span lang=EN-US>except</span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
writeln(<i><span style='color:blue'>'an exception occurred!'</span></i>);</span></p>

<p class=MsoNormal><b>end</b>;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b>end</b>.</p>

</div>

</body>

</html>
