<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Synan: /TestSynanCOM/TestSynanCOM.cpp</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>/TestSynanCOM/TestSynanCOM.cpp</h1><div class="fragment"><pre class="fragment"><span class="comment">/*</span>
<span class="comment"> This is an example of how to use COM-interfaces of Dialing Syntax.  </span>
<span class="comment"> The program processes a sentence, and then prints all found syntax groups </span>
<span class="comment"></span>
<span class="comment">*/</span>
<span class="preprocessor">#include "../common/COMSyntaxHolder.h"</span>
<span class="preprocessor">#include "../common/utilit.h"</span>

<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])
{
        ::CoInitialize(0);
        


        {
                <span class="comment">// loading Russian syntax</span>
                CCOMSyntaxHolder        SyntaxHolder;
                <span class="keywordflow">if</span> (!SyntaxHolder.LoadSyntax(morphRussian))
                        <span class="keywordflow">return</span> -1;

                <span class="comment">// processing one Russian sentence (from Graphematics to Syntax)</span>
                <span class="keywordflow">if</span> (!SyntaxHolder.GetSentencesFromSynAn(<span class="stringliteral">"мама мыла раму"</span>, FALSE, FALSE, FALSE))
                        <span class="keywordflow">return</span> -1;

                <span class="comment">// printing all syntax groups</span>

                <span class="comment">// going through all sentences</span>
                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; SyntaxHolder.m_piSentCollection-&gt;SentencesCount ; i++ )
                {
                        SYNANLib::ISentencePtr piSent = SyntaxHolder.m_piSentCollection-&gt;GetSentence(i);

                        <span class="comment">// going through all clauses in this sentence</span>
                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0 ; j &lt; piSent-&gt;ClausesCount ; j++ )
                        {
                                SYNANLib::IClausePtr piClause = piSent-&gt;Clause[j];
                                <span class="comment">//  getting the first morphological variant</span>
                                <span class="keywordflow">if</span> (piClause-&gt;VariantsCount == 0)
                                {
                                        printf (<span class="stringliteral">" Error! A clause with no morph. variant is found\n"</span>); 
                                        <span class="keywordflow">continue</span>;
                                };

                                <span class="comment">// going through all syntax groups</span>
                                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0 ; k &lt; piClause-&gt;ClauseVariant[0]-&gt;GroupsCount ; k++ )
                                {
                                        
                                        SYNANLib::IGroupPtr piGroup = piClause-&gt;ClauseVariant[0]-&gt;Group[k];
                                        SYNANLib::IWordPtr piW1 = piSent-&gt;Word[piGroup-&gt;FirstWord];
                                        SYNANLib::IWordPtr piW2 = piSent-&gt;Word[piGroup-&gt;LastWord];
                                        printf(<span class="stringliteral">"(%s %s %s )\n"</span>, 
                                                        (<span class="keyword">const</span> <span class="keywordtype">char</span>*)piGroup-&gt;TypeStr, 
                                                        (<span class="keyword">const</span> <span class="keywordtype">char</span>*)piW1-&gt;WordStr, 
                                                        (<span class="keyword">const</span> <span class="keywordtype">char</span>*)piW2-&gt;WordStr
                                                        );                              
                                }

                        }
                        
                }

        }
        ::CoUninitialize();
        <span class="keywordflow">return</span> 0;
}
</pre></div> <hr size="1"><address style="align: right;"><small>Generated on Tue Feb 7 15:38:48 2006 for Synan by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.4 </small></address>
</body>
</html>
