4.8 Использование файла своппинга 


Вместо того, чтобы резервировать специальные разделы для области своппинга, вы можете использовать файл. Однако, чтобы это сделать, вы должны инсталлировать программы Linux и предварительно сделать все, что необходимо для создания файлов своппинга.

 


Если у вас есть инсталлированная система Linux, вы можете использовать следующие команды для создания файла своппинга. Ниже мы собираемся создать файл своппинга размером в 8208 блоков (около 8 Мбайт).

 

       # dd if=/dev/zero of=/swap bs=1024 count=8208




Эта команда создает файл своппинга. Замените ``count='' размером файла своппинга в блоках.

 

       # mkswap /swap 8208




Эта команда инициализирует swap-файл; вновь замените имя и размер своп-файла соответствующими значениями.

 

       # /etc/sync
       # swapon /swap




Теперь в своппинге будет задействован файл /swap, который мы создали, после синхронизации, которая гарантирует, что файл был записан на диск.

 


Главная неприятность, связанная с использованием swap-файлов, состоит в том, что доступ к ним происходит через файловую систему. Это означает, что блоки, составляющие swap-файл могут быть не смежними на диске. То есть скорость своппинга при использовании swap-файла ниже, чем при использовании swap-раздела, для которой блоки всегда смежны (последовательны) и запросы на ввод/вывод происходят прямо к устройству.

 


Другая проблема, связанная с использованием swap-файла, это возможность испортить информацию в файловой системе - при использовании больших файлов своппинга существует шанс, что вы попортите систему, если что-то происходит неправильно. Имея раздел своппинга отдельно от файловой системы вы страхуетесь от таких неприятностей.

 


Использование файла своппинга может быть очень полезным, если у вас есть временная потребность в дополнительном пространстве для своппинга. Например, если вы компилируете большую программу и хотите ускорить дело, вы можете временно создать файл своппинга и использовать его в дополнение к имеющейся области своппинга.

 


Для того, чтобы избавиться от файла своппинга, вначале используйте swapoff

 

    # swapoff /swap




А теперь вы можете смело удалить файл.

 

    # rm /swap




Помните, что каждый файл своппинга (или раздел) может быть размером до 16 Мбайт, но вы можете использовать до 8 файлов своппинга или разделов на своей системе.

 


